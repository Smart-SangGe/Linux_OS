# 2023-2024第一学期《Linux操作系统》期末大作业

## 一、考核目标与要求

本课程主要考察学生对Linux操作系统基本命令掌握情况、利用所学知识分析、解决实际问题的能力及实际动手能力。期末考试要求完成《Linux操作系统》综合报告。本大型作业，要求学生根据考试要求，运用所学知识与技术手段，通过实际操作达成任务目标，并形成完整的作业步骤记录和分析报告。

## 二、大作业内容

以下三套试题，学生任选其一完成。

### （一）Linux系统综合测试

#### 1. 系统概要

请在虚拟机上安装Ubuntu操作系统（请务必重新安装，不要使用已安装的操作系统，避免被误判为抄袭），完成以下操作：

1. 查看内核和操作系统版本
2. 查看MAC地址，硬件地址
3. 查看系统的后台任务
4. 测试当前主机是否能与百度网站进行联通
5. 如何查看系统中已注册的中断及访问频次（1秒更新一次）
6. 使用什么命令查看磁盘使用空间？空闲空间呢?
7. 查看当前谁在使用该主机用什么命令?查找自己所在的终端信息用什么命令?
8. 如何让系统启动时自动开启防火墙，并且允许IP段192.168.0.0/24访问端口20。

要求逐项列出查询命令及结果截图；如需安装新工具，请列出安装命令和结果截图。

#### 2. 基本操作

1. 创建一个名为"examusers"的用户组。添加三个用户到这个用户组：user1、user2、user3。为这三个用户设置密码，并确保用户可以使用密码登录。设置用户1（user1）仅具有读取一个特定目录的权限，用户2（user2）可以读取和写入该目录，而用户3（user3）则拥有完全权限。
2. gcc命令的常用选项：-Wall、-l、-c、-o、-g。使用下面提供的代码并用这些选项编译程序，再通过gdb调试程序。

```c
#include <stdio.h>
int main(){
    int i =1, j =0;
    j = i++;
    printf("i = %d , j = %d\n",i , j);
}
```

#### 3. 进阶操作

1. 伙伴算法（buddy算法），是为了核心内存管理能够快速响应请求，尽可能地在提高内存利用率的同时减少内存碎片的一种算法。
2. Ext4作为大多数Linux发行版中的默认文件系统，Ext4文件系统中，每个文件都有且仅有一个inode，inode记录了文件的权限、属性以及数据所在的块block号码。

#### 4. 其他要求

1. 独立完成大作业项目。
2. 虚拟机以自己的学号+名字拼音首字母命名，如张三的虚拟机命名为“2020001zs”。
3. 所有的操作结果都要有截图，程序要有完整的代码。
4. 完成大作业后必须提交以下内容：大作业报告（电子版）为

doc或docx格式，必须以自己的学号+名字命名，如“2020001张三”。

### （二）Minishell理解与改进

#### 1. 考核内容

通过重新编译运行和使用minishell，了解shell的实现原理，了解shell与Linux操作系统的关系，了解minishell实现过程中，调用的C语言函数库与Linux系统调用的关系。要点如下：

##### （1）Minishell编译、运行与调试

- Makefile文件编写，掌握多个.c源文件的自动编译。
- 用printf对程序进行调试。比如，运行minishell，对如下命令进行调试，打印出shell程序在解析命令行参数时的关键参数。

##### （2）关键数据结构

- 实现minishell时，会使用到一些数据结构来保存相应功能的数据。
- 分析全局变量的使用和意义。

##### （3）minishell内部支持函数

- 分析parse.c中出现的基本函数，如check、getname和get_command。
- 特别是get_command函数的实现和使用。

##### （4）minishell使用的库函数

- 理解minishell中使用的库函数，包括但不限于：fgets、printf、malloc、memset、open、fchdir、close、dup、signal、kill、fork、execvp、setpgid、wait、exit、pipe等。
- 分析这些库函数与Linux操作系统的系统调用之间的关系。

##### （5）库函数与Linux操作系统的系统调用关系

- 结合前面布置的系统调用总结的作业，将库函数所对应的Linux系统调用进行总结和分析。
- 特别关注加粗字体的函数调用所对应的系统调用的实现原理。

##### （6）minishell实现的整体结构分析

#### 2. 作业要求

根据学习内容，形成《Minishell源码分析报告》。

#### 3. 进阶要求

- 对socket.zip中的Linux网络通信程序进行修改，将其添加到minishell中。
- 修改后的minishell应能自动记录键盘输入内容并通过网络发送到远端电脑。
- 重点是学习Linux操作系统下的socket套接口编程。
- 修改代码时要注意修改IP地址及端口号。
- 运行时，先运行服务端再运行客户端。

### （三）Linux文件删除保护功能实践

#### 1. 考核内容

##### （1）用户空间代码分析工作

- 分析文件删除命令rm的源代码。
- 描述rm命令执行过程的流程图。
- 找到rm命令使用的删除文件的系统调用。
- 选择合适的文件拓展属性标记作为删除保护的标记。

##### （2）内核空间代码分析工作

- 分析内核源代码中VFS系统与删除文件系统调用相关代码。
- 分析ext3/4文件系统中与VFS文件系统中与删除文件系统调用相关代码。
- 分析ext3/4文件系统中文件拓展属性标记检查相关函数。

##### （3）实践部分工作

- 在ext3/4文件系统删除文件函数中加入拓展属性标记检查。
- 如果拓展属性标记被置位，则禁止删除文件。

##### （4）测试

- 文件置位删除保护位。
- 使用命令rm 删除文件失败。

#### 2. 基本要求

1. 终端命令提示符之前显示名字信息。
2. 在具体操作之前, 需有总体设计的思路介绍及流程图。
3. 运行结果各个步骤有截图及相应的解释。
4. 程序分析过程需要文字描述和流程图。
5. 基于最新版本的Debian或Ubuntu操作系统。

#### 3. 格式要求

1. 文件使用Markdown格式。
2. 流程图按照平时作业的要求嵌入Markdown文件中。
3. 所有文件放在以学号命名的目录中。
4. 文件命名使用数字、英文字符, 不要使用中文。
5. 目录压缩为zip文件, 并加密上传群中.
